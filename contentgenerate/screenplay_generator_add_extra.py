

from langchain_community.llms.tongyi import Tongyi
from langchain.chains import LLMChain
from langchain.prompts import PromptTemplate
import dashscope


DASHSCOPE_API_KEY="sk-a48a1d84e015410292d07021f60b9acb"
import os
os.environ["DASHSCOPE_API_KEY"] = DASHSCOPE_API_KEY

from contentgenerate import llm_base
# import llm_base


def get_screenplay_add_extra(screenplay,voices,BGMS,fonts):
    template='''
       ###背景：
      我们有一个短视频脚本，描述了视频的整体结构和每个部分的内容需求。此外，我们还提供了配音库、BGM库和字体库，用于为视频添加配音、背景音乐和字体样式。现在需要利用这些信息来为短视频脚本添加具体的配音、BGM和字体设定，并按照指定格式输出。

      ###目标：
      请根据提供的短视频脚本以及配音库、BGM库和字体库，为短视频脚本添加配音、背景音乐和字体设定，并按照以下格式输出最终结果。

      ###风格：
      采用专业的视频编辑和创意策划风格，注重细节和逻辑连贯性，确保输出的设定既实用又高效。

      ###语气：
      使用简洁明了的语气，旨在清晰传达每个镜头的具体要求，便于后续的剪辑、配音和字幕制作工作。

      ###输出格式：
       编号: 森咖啡-script1
            工程: 森咖啡
            标题: 快乐氛围
            配音: zh-CN-YunxiNeural
            字体: yishu.ttf
            字号: 80
            BGM : Diffrent.mp3
            脚本: 
            - 镜头: 展示
                内容: 森咖啡为您创造愉快的氛围就像与小猫玩耍一样快乐充满每一个角落
            - 镜头: 展示
                内容: 在这个温馨的大厅中幸福的氛围伴随着香浓的咖啡让您的心情愉悦起来
            - 镜头: 展示
                内容: 舒适的卡座营造出宜人的快乐氛围让您与亲友共度美好的时光
            - 镜头: 展示
                内容: 在舒适的卡座中与亲友共享美味咖啡每一刻都充满了快乐和欢笑
            - 镜头: 展示
                内容: 当您需要一份快乐森咖啡的大门随时为您敞开让您进入快乐的世界
      
      ###步骤：
      为了实现上述目标，请遵循以下步骤进行研究和撰写：

      ##理解短视频脚本
      仔细阅读短视频脚本，明确每个部分的主题、核心信息和情感诉求。
      ##分析资源库
      审查提供的配音库、BGM库和字体库，理解每个资源的特点及其适用场景。
      ##挑选合适的资源
      根据短视频脚本的需求，从配音库中挑选最适合的配音文件或配音演员。
      从BGM库中挑选适合的背景音乐文件，确保其情感氛围与视频内容相匹配。
      从字体库中挑选合适的字体样式，确保其视觉效果与品牌形象一致。
      ##编写设定脚本
      将选定的配音、BGM和字体设定按照指定格式添加到短视频脚本中。
      确保每个镜头的内容简洁明了，可以直接作为旁白配音使用，并且所有设定都符合视频的整体风格。
      
      ##示例应用：
      #假设您的短视频脚本如下：

      镜头1（素材名：晒伤皮肤对比图）
      内容：晒伤？看这里！看看晒伤前后的对比图，皮肤问题不容忽视。

      镜头2（素材名：三步修复流程动画）
      内容：只需三步，轻松修复晒伤肌肤。第一步清洁，第二步涂抹精华液，第三步锁水保湿。

      镜头3（素材名：产品特写）
      内容：这就是我们的产品，专为高效修复而设计。

      镜头4（素材名：用户反馈截图）
      内容：看看其他用户的反馈，效果显著，让美丽触手可及！

      镜头5（素材名：产品图片）
      内容：立即体验[产品名称]，让你的肌肤焕然一新！
      
      #提供的示例资源库如下,配音库括号内为对配音的描述，不要出现，同时，这里出现的仅作为示例用：

      配音库：（1）zh-CN-XiaoxiaoNeural(Female，News, Novel，Warm)、（2）zh-CN-YunjianNeural（Male，Sports, Novel，Passion）、（3）zh-CN-YunxiNeural（Male，Novel，Lively, Sunshine）
      BGM库：Diffrent.mp3（舒缓的轻音乐）、activa.mp3(激励背景音乐1)、nature.mp3(舒缓背景音乐)
      字体库：Arial Bold、Helvetica Neue、Futura PT、yishu.ttf
      
      #编写的设定脚本示例：

       编号: 晒伤修复-script1
            工程: 晒伤修复
            标题: 晒伤？看这里！教你三步快速修复
            配音: zh-CN-YunxiNeural
            字体: yishu.ttf
            字号: 80
            BGM : Diffrent.mp3
            脚本: 
            - 镜头: 晒伤皮肤对比图
                内容: 晒伤？看这里！看看晒伤前后的对比图，皮肤问题不容忽视。
            - 镜头: 三步修复流程动画
                内容: 只需三步，轻松修复晒伤肌肤。第一步清洁，第二步涂抹精华液，第三步锁水保湿。
            - 镜头: 产品特写
                内容: 这就是我们的产品，专为高效修复而设计。
            - 镜头: 用户反馈截图
                内容: 看看其他用户的反馈，效果显著，让美丽触手可及！
            - 镜头: 产品图片
                内容: 立即体验[产品名称]，让你的肌肤焕然一新！
    
        '''


    input=''''
        以下是你需要结合的
        ###短视频脚本：
        {screenplay}
        ### 配音库
        {voices}
        ### BGM库
        {BGMS}
        ### 字体库
        {fonts}
       



    '''
    template=template.format()
    input=input.format(screenplay=screenplay,voices=voices,BGMS=BGMS,fonts=fonts)
    res=llm_base.get_Tongyi_response(template,input)
    return res



if __name__ == '__main__':
    
    voices="配音库：（1）zh-CN-XiaoxiaoNeural(Female，News, Novel，Warm)、（2）zh-CN-YunjianNeural（Male，Sports, Novel，Passion）、（3）zh-CN-YunxiNeural（Male，Novel，Lively, Sunshine）"
    BGMS="BGM库：Diffrent.mp3（舒缓的轻音乐）、activa.mp3(激励背景音乐1)、nature.mp3(舒缓背景音乐)"
    fonts="字体库：Arial Bold.ttf、Helvetica Neue.ttf、Futura PT.ttf、yishu.ttf"
    
  

    screenplay='''# 结构化输出

### 需求挖掘（金字塔关键词法）

#### 塔尖：行业核心词
- **智能客服平台**
- **客户服务管理**

#### 塔腰：场景细分词
- **中小企业客服管理**
- **电商客户体验优化**
- **大型企业数字化转型**

#### 塔基：长尾需求词
- **多渠道集成解决方案**
- **实时监控与报表分析**
- **快速部署与系统对接**
- **自动化客服流程**

### 情绪转折情节设计（情绪坐标轴）

#### X轴：情绪强度 - 从弱到强
#### Y轴：情绪类型 - 定义情绪类型为积极或消极，爆款集中在强消极情绪（如焦虑、压力）转向强积极情绪（如解决、成功）

**具体情节示例：**
- **开头（强消极情绪）：** CEO在忙碌的一天中突然接到紧急客户问题，感到极度焦虑和压力。
- **中间（过渡）：** CEO通过使用全渠道智能客服平台，迅速解决了问题，并实时监控客服团队的表现，逐步缓解压力。
- **结尾（强积极情绪）：** CEO不仅解决了问题，还提高了团队效率，增强了客户满意度，最终实现业务增长。

### 短视频脚本

#### 开头语句
“deepseek又放大招了！你是否曾因客户问题而感到手忙脚乱？今天，我们将展示如何通过全渠道智能客服平台轻松应对各种挑战。”

#### 主体内容

1. **场景描述：**
   - **镜头一：忙碌的CEO办公室**
     - 视觉元素：蓝色和绿色为主色调的现代办公环境，CEO坐在桌前处理各种事务。
     - 对话/旁白：“每天都有无数的任务等待处理，突然一个紧急客户问题打乱了一切。”
     - 音乐：轻快但略带紧张感的背景音乐。

   - **镜头二：CEO使用智能客服平台**
     - 视觉元素：屏幕显示智能客服平台界面，展示多渠道集成、智能分发等功能。
     - 对话/旁白：“只需几分钟，问题迎刃而解。实时监控功能让一切尽在掌握。”
     - 音乐：节奏逐渐加快，充满活力。

2. **功能演示：**
   - **镜头三：可视化报表工具**
     - 视觉元素：动态图标展示数据驱动决策的过程，图表和数据流动画。
     - 对话/旁白：“利用可视化报表工具，您可以直观地了解客服绩效，做出更明智的决策。”
     - 音乐：轻快且激励人心。

3. **用户案例展示：**
   - **镜头四：传统制造企业的转变**
     - 视觉元素：工厂车间到现代化办公区的转变，员工操作智能客服平台的画面。
     - 对话/旁白：“一家传统制造企业通过引入智能客服平台，实现了客服流程的自动化和智能化，显著提高了客户满意度。”
     - 音乐：激昂且鼓舞人心。

#### 结尾总结
“试试全渠道智能客服平台，让您的业务更加高效、智能，推动整体业务升级！立即行动，点赞、分享并订阅我们，获取更多实用信息！”

### 总结

通过结合热点词“美白”和改写的热点开头语“deepseek又放大招了”，我们将主题聚焦于全渠道智能客服平台的核心优势，同时通过情绪转折情节设计，从强消极情绪转向强积极情绪，增强观众的情感共鸣。视觉记忆点的设计确保了品牌的统一性和专业性 ，使视频更具吸引力和说服力。
'''
    get_screenplay_add_extra(screenplay,voices,BGMS,fonts)



