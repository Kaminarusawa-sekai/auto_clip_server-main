

from langchain_community.llms.tongyi import Tongyi
from langchain.chains import LLMChain
from langchain.prompts import PromptTemplate
import dashscope


DASHSCOPE_API_KEY="sk-a48a1d84e015410292d07021f60b9acb"
import os
os.environ["DASHSCOPE_API_KEY"] = DASHSCOPE_API_KEY

from contentgenerate import llm_base
# import llm_base


def get_screenplay_redbook(market_plan,hot_point,hot_start):
    template='''
        ###背景：
        我们已经有一个短视频大纲，其中包括了基础赛道、特殊身份和视觉记忆点。现在，我们需要结合提供的热点词和开头语句，使用【金字塔关键词法】挖掘目标客户的需求，并通过【情绪坐标轴】设计情绪转折情节来增强视频的吸引力和共鸣效果。

        ###目标：
        请根据提供的短视频大纲、热点词及开头语句，将结合大纲使用热点词，并根据大纲改写开头语句使其符合大纲主题，采用【金字塔关键词法】挖掘客户需求，并利用【情绪坐标轴】设计情绪转折情节，以生成一段能够有效吸引并触动目标客户的短视频脚本。

        ###风格：
        采用创意策划专家的专业写作风格，注重情感共鸣和实际操作性，确保内容既富有创意又能引起观众的情感共鸣。

        ###语气：
        使用积极且激励人心的语气，旨在激发观众的积极性，同时保持专业性和可行性。

        ###受众：
        这份脚本面向的是视频制作团队、创意策划人员及品牌经理，他们需要具体的创意指导来高效地生产高质量的短视频内容。

        ###注意
        请注意，热点词和热点语句未必和大纲有关系，没有关系你需要通过合理的方式进行结合

        ###输出：
        请以结构化的格式呈现结果，包括但不限于以下部分：

        需求挖掘（金字塔关键词法）
        情绪转折情节设计（情绪坐标轴）
        短视频脚本

        ###步骤：
        为了实现上述目标，请遵循以下步骤进行研究和撰写：

        ##需求挖掘（金字塔关键词法）
        塔尖：行业核心词 - 根据提供的短视频大纲，确定行业核心词（如“护肤”、“健身”等）。
        塔腰：场景细分词 - 结合目标客户画像分析，识别特定场景下的细分需求（如“学生党护肤”、“上班族快速健身”）。
        塔基：长尾需求词 - 深入挖掘更具体的需求（如“军训晒后修复急救方法”、“办公室久坐缓解疲劳操”）。
        ##情绪转折情节设计（情绪坐标轴）
        X轴：情绪强度 - 从弱到强，设定情绪的变化路径。
        Y轴：情绪类型 - 定义情绪类型为积极或消极，爆款集中在强消极情绪（如焦虑、愤怒）转向强积极情绪（如治愈、爽感）。
        提供具体的情节示例，展示如何从一个消极痛点（如“见客户画错了妆被扣分”）过渡到一个积极解决方案（如“3招化妆化出女老板气场”）。
        ##短视频脚本
        开头语句 - 使用提供的开头语句并结合主题进行改写引入主题，迅速抓住观众的注意力。
        主体内容 - 根据需求挖掘的结果和情绪转折情节设计，编写详细的故事线，包括场景描述、对话/旁白文本、视觉元素说明以及音乐和音效建议。
        结尾总结 - 强调产品或服务的价值主张，鼓励观众采取行动（如点赞、分享、订阅）。

        ###示例：

        假设您的产品是一款针对年轻女性的智能美容仪，热点词包括“大S”。热点开头语为"太让人震撼了，IT又有新方向"

        需求挖掘：
        塔尖：护肤
        塔腰：学生党护肤
        塔基：军训晒后修复急救方法
        情绪转折情节设计：
        开头：一位大学生在军训后满脸晒伤，感到非常沮丧（强消极情绪）。
        中间：她尝试了多种方法，但效果不佳，直到发现了智能美容仪。
        结尾：通过使用美容仪，她的皮肤得到了显著改善，恢复自信（强积极情绪）。
        短视频脚本：
        开头：“太让人震撼了，护肤又有新方向（此句为热点语句改写而来），你是否经历过这样的尴尬？军训结束后，脸上满是晒伤，心情跌到了谷底。”
        主体：“今天，我们将教你三招大S（热点词）也用的高效护肤的方法，让你告别晒后困扰。”
        结尾：“试试[产品名称]，让美丽触手可及！”
        '''


    input=''''
        以下是你需要结合的
        ###短视频大纲：
        {market_plan}
        ### 热点词
        {hot_point}
        ### 你需要结合主题改写的热点开头语
        {hot_start}


    '''
    template=template.format()
    input=input.format(market_plan=market_plan,hot_point=hot_point,hot_start=hot_start)
    res=llm_base.get_Tongyi_response(template,input)
    return res



if __name__ == '__main__':
    
    hot_point="美白"
    hot_start="deepseek又放大招了"

    market_plan='''### 全渠道智能客服平台短视频内容策略大纲

#### 1. 基础赛道视频概念

**定义基础赛道：**
全渠道智能客服平台定位于提供高效、便捷且低成本的客户服务管理工具，特别适用于中小型企业和大型企业集团中的客服部门。其核心优势在于多渠道集成与智能分发、可视化报表工具和API接口对接。

**创意方向：**
- **用户案例展示：** 通过真实用户的成功故事，展示产品如何帮助企业提升客户服务效率，降低成本，并实现数字化转型。
- **功能演示：** 制作一系列简短的功能演示视频，重点介绍多渠道集成、智能分发、可视化报表等关键特性。
- **行业应用：** 针对不同行业（如电商、SaaS、零售等）制作定制化视频，展示平台在各行业的实际应用场景和效果。

**主题示例：**
1. **“从混乱到有序”——某电商公司如何通过智能客服平台优化客户体验**
2. **“数据驱动决策”——利用可视化报表工具提升客服绩效**
3. **“无缝集成的力量”——中小企业如何快速部署并与其他系统完美对接**

#### 2. 特殊身份视频概念

**识别目标客户的独特需求和偏好：**
根据客户画像分析，目标客户主要为中小企业的创始人、高层管理人员以及大型企业集团中的客服部门负责人。他们重视工作效率、成本控制、技术创新和数字化转型。

**强调特殊身份：**
- **智能服务专家：** 强调平台作为“智能服务专家”的角色，帮助企业在复杂多变的市场环境中保持竞争力。
- **数字化转型伙伴：** 定位为“数字化转型伙伴”，协助企业以较低成本实现高效客服管理，推动整体业务升级。

**故事情节或情景设定：**
1. **“忙碌CEO的一天”——一位创业公司CEO如何借助智能客服平台应对日常挑战**
   - 情景设定：CEO在办公室处理各种事务，突然接到紧急客户问题。通过使用智能客服平台，他迅速解决了问题，并实时监控客服团队的表现。
2. **“从传统到现代”——一家传统制造企业如何通过数字化转型提升服务质量**
   - 情景设定：一家传统制造企业的客服部门负责人，在引入智能客服平台后，实现了客服流程的自动化和智能化，显著提高了客户满意度。

#### 3. 视觉记忆点设计指南

**视觉元素设计建议：**
- **主色调：** 采用蓝色和绿色为主色调，传达专业、可靠和环保的品牌形象。
- **字体选择：** 使用简洁、现代的无衬线字体（如Roboto或Helvetica），确保文字清晰易读。
- **动画风格：** 结合流畅的动态图标和简洁的动画效果，突出科技感和智能化特点。
- **背景音乐：** 选择轻快、激励人心的背景音乐，营造积极向上的氛围。

**传达品牌价值观和情感诉求：**
- **信任与可靠性：** 通过稳定、专业的视觉呈现，传递品牌的可靠性和安全性。
- **创新与活力：** 利用现代感强的设计元素，展现品牌的创新精神和活力。

**一致应用指南：**
- **开篇与结尾：** 每个视频的开头和结尾都使用统一的品牌标识和口号，增强品牌认知度。
- **场景切换：** 在不同类型的视频中保持一致的转场效果和视觉风格，确保品牌形象连贯。
- **信息层次：** 合理安排信息层次，确保重要信息突出，次要信息辅助，使观众易于理解。

#### 整合与优化

**形成统一的品牌形象：**
将上述三个方面的内容整合成一个连贯的整体，确保每个短视频都能准确传达全渠道智能客服平台的核心价值和独特卖点。通过用户案例、功能演示和情感共鸣的故事设定，吸引并留住目标受众。同时，保持一致的视觉风格和品牌调性，强化品牌记忆点 。

**反馈与调整：**
根据初步反馈，不断优化视频内容结构和表现形式，确保最终作品既具有吸引力又易于实施。定期评估视频效果，及时调整策略，以适应市场变化和客户需求。
'''
    get_screenplay_redbook(market_plan,hot_point,hot_start)



